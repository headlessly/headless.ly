# public/ — The @headlessly Package Repository

This repo contains the published `@headlessly/*` packages, documentation, CLI, and tests.

## Editing Policy

Direct edits are welcome. This content is hand-crafted for quality. When the package count grows to thousands, generation pipelines will take over — but right now, every doc page and README should be written to be excellent, not templated to be consistent.

## What Lives Here

```
docs/           → Fumadocs MDX documentation (headless.ly)
industries/     → Industry packages (@headlessly/farm-soybeans, etc.)
processes/      → Process packages (@headlessly/develop-strategy, etc.)
tasks/          → Task packages (@headlessly/manage-organizational-budgets, etc.)
departments/    → Department packages (@headlessly/accounts-payable, etc.)
```

## SDK Conventions (Critical)

All code examples MUST use the current `@headlessly/*` package naming. We own the `@headlessly` npm scope. `@headlessly/sdk@0.0.1` is published.

### Three Import Styles

**1. Universal context (`$`)** — full access to every entity:

```typescript
import { $ } from '@headlessly/sdk'

await $.Contact.create({ name: 'Alice', stage: 'Lead' })
await $.Deal.close({ id: 'deal_1' })
```

**2. Direct entity imports** — domain-specific packages:

```typescript
import { Contact, Deal } from '@headlessly/crm'
import { Subscription } from '@headlessly/billing'

await Contact.create({ name: 'Alice', stage: 'Lead' })
await Deal.close({ id: 'deal_1' })
```

**3. Domain namespace imports** — grouping by product domain:

```typescript
import { crm, billing } from '@headlessly/sdk'

await crm.Contact.create({ name: 'Alice', stage: 'Lead' })
await billing.Subscription.create({ plan: 'pro', contact: 'contact_1' })
```

### Package Hierarchy

| Layer | Packages | Purpose |
|---|---|---|
| **SDK** | `@headlessly/sdk` | Full 32-entity graph, exports `$` and domain namespaces |
| **CLI** | `@headlessly/cli` | CLI entry point (`npx @headlessly/cli`) |
| **Domain** | `crm`, `billing`, `projects`, `content`, `support`, `analytics`, `marketing`, `experiments`, `platform` | Each owns a set of entities |
| **Lifecycle** | `build`, `launch`, `experiment`, `grow`, `sell`, `market`, `automate`, `scale` | Same entities, organized by startup phase |
| **Business model** | `b2b`, `b2c`, `b2d`, `b2a` | Same entities, organized by business model |
| **Industry** | `farm-soybeans`, `manufacture-steel`, etc. | Industry-specific Business-as-Code APIs |
| **Task** | `manage-organizational-budgets`, etc. | Task-specific Business-as-Code APIs |

### Domain-to-Entity Mapping

- `@headlessly/crm` — Contact, Company, Deal
- `@headlessly/billing` — Customer, Product, Price, Subscription, Invoice, Payment
- `@headlessly/projects` — Project, Issue, Comment
- `@headlessly/content` — Content, Asset, Site
- `@headlessly/support` — Ticket
- `@headlessly/analytics` — Event, Metric, Funnel, Goal
- `@headlessly/marketing` — Campaign, Segment, Form
- `@headlessly/experiments` — Experiment, FeatureFlag
- `@headlessly/platform` — Workflow, Integration, Agent

### Entity IDs

Entity IDs use the format `{type}_{sqid}` where the suffix is generated by [sqids](https://sqids.org/) — short, unique, URL-safe, with a built-in blocklist to prevent offensive strings.

- `contact_fX9bL5nRd`, `deal_k7TmPvQx`, `project_e5JhLzXc`
- Never use sequential numeric IDs: `contact_1`, `contact_847`
- Never use obviously fake IDs: `contact_123`, `contact_abc`
- Keep IDs consistent within a single file

### Tenant Configuration

Tenant is configured via the `HEADLESSLY_TENANT` environment variable. Never pass `{ tenant: '...' }` explicitly.

### MCP Tool Representation

headless.ly exposes three MCP tools: `search`, `fetch`, `do`. Represent them with titled code blocks:

```json title="headless.ly/mcp#search"
{ "type": "Contact", "filter": { "stage": "Lead" } }
```

```json title="headless.ly/mcp#fetch"
{ "type": "Contact", "id": "contact_123", "include": ["deals"] }
```

```ts title="headless.ly/mcp#do"
const leads = await $.Contact.find({ stage: 'Lead' })
for (const lead of leads) {
  await $.Contact.qualify(lead.$id)
}
```

### CLI Entry Point

```bash
npx @headlessly/cli
```

### What NOT to Write

```typescript
// WRONG — old pattern
import Headlessly from 'headless.ly'
const org = Headlessly({ tenant: 'my-startup' })
org.Contact.create(...)

// WRONG — headless.ly is not a valid npm package name
import { Contact } from 'headless.ly'

// WRONG — MCP tools are not function calls
search({ type: 'Contact', filter: { stage: 'Lead' } })
do({ method: 'Contact.qualify', args: ['contact_1'] })
```

## Code Style

- No semicolons, single quotes, 2-space indent (project Prettier config)
- Always include import statements
- Always show the full operation, not a fragment
- Prefer `const` over `let`
- Use meaningful variable names

## Source Relationships

When content here overlaps with source data:
- Industry MDX source → `.org.ai/industries/`
- Process MDX source → `.org.ai/processes/`
- Task MDX source → `.org.ai/tasks/`
- Department MDX source → `.org.ai/departments/`
- Schema definitions → `.db/index.ts`
- Generation scripts → `scripts/generate-packages.ts`
