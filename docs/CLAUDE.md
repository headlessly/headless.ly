# Documentation Authoring Guide

> Inherits SDK conventions from `public/CLAUDE.md`. This file covers docs-specific rules.

## Framework

[Fumadocs](https://fumadocs.vercel.app/) on Next.js. MDX files with YAML frontmatter.

### Frontmatter

```yaml
---
title: Page Title
description: One-sentence description for meta tags and search.
icon: LucideIconName  # Optional — Lucide icon for sidebar
---
```

### Components

- `<Cards>` / `<Card title="..." href="...">` — navigation cards
- `<Callout type="info|warn|error">` — callouts
- Standard MDX code blocks with language and optional `title` attribute

### Page Ordering

`meta.json` in each directory controls sidebar order:

```json
{
  "title": "Section Name",
  "pages": ["page-a", "page-b", "page-c"]
}
```

## Structure

### Journey Phases (Guides)

```
build/       → Day 0-30: Setup, SDK, concepts, MCP
launch/      → Day 30: Campaigns, pages, forms
experiment/  → Day 30-60: A/B tests, feature flags, funnels
grow/        → Day 30-90: CRM, deals, billing, support
automate/    → Day 60+: Workflows, agents, integrations
scale/       → Day 90+: Metrics, goals, dashboards, lakehouse
```

Each journey page opens with a hero code block showing the key operations for that phase, then lists key entities with verb tables, then shows event-driven automation patterns.

### Entities (Root Tab)

```
entities/        → All 35 entities with Noun() definitions and verb tables
├── identity     → User, ApiKey
├── crm          → Organization, Contact, Lead, Deal, Activity, Pipeline
├── billing      → Customer, Product, Plan, Price, Subscription, Invoice, Payment
├── projects     → Project, Issue, Comment
├── content      → Content, Asset, Site
├── support      → Ticket
├── analytics    → Event, Metric, Funnel, Goal
├── marketing    → Campaign, Segment, Form
├── experimentation → Experiment, FeatureFlag
├── platform     → Workflow, Integration, Agent
└── communication → Message
```

### Reference (API Docs)

```
reference/
├── integrations/ → Stripe, GitHub, Analytics, Dashboards
├── sdk/         → SDK API reference
├── mcp/         → MCP tool reference
├── rest/        → REST API reference
├── cli/         → CLI reference
└── concepts/    → Digital Objects, Verbs, Architecture, Events
```

## SDK Code Conventions

All code examples MUST use the current `@headlessly/*` imports. See `public/CLAUDE.md` for the three import styles.

### Choosing the Right Import Style

- **Journey pages** (build, launch, grow, etc.): Use direct entity imports from domain packages. A CRM example uses `import { Contact, Deal } from '@headlessly/crm'`. This is the most common style.
- **Cross-domain examples**: Use `$` from `@headlessly/sdk` when the example touches multiple domains.
- **Event handlers**: Use direct entity imports. The `$` context is available as a second callback argument for cross-entity access:

```typescript
import { Deal } from '@headlessly/crm'

Deal.closed((deal, $) => {
  $.Subscription.create({ plan: 'pro', contact: deal.contact })
})
```

### Verb Conjugation in Examples

Show the full lifecycle when demonstrating verbs:

```typescript
import { Contact } from '@headlessly/crm'

await Contact.qualify({ id: 'contact_1' })           // execute
Contact.qualifying(contact => { /* BEFORE hook */ })  // before
Contact.qualified(contact => { /* AFTER hook */ })    // after
```

### MCP Tools in Docs

Use titled code blocks, not function-call syntax:

```json title="headless.ly/mcp#search"
{ "type": "Contact", "filter": { "stage": "Lead" } }
```

```ts title="headless.ly/mcp#do"
await $.Contact.qualify({ id: 'contact_1' })
```

### CLI Examples

```bash
npx @headlessly/cli status
npx @headlessly/cli Contact.create --name "Alice" --stage Lead
npx @headlessly/cli do Contact.qualify contact_1
```

### Install Commands

```bash
# SDK
npm install @headlessly/sdk

# Or domain-specific
npm install @headlessly/crm

# CLI (no install needed)
npx @headlessly/cli
```

## What NOT to Write

These patterns are deprecated and must never appear in docs:

```typescript
// WRONG — old default export
import Headlessly from '@headlessly/sdk'
const org = Headlessly({ tenant: 'my-startup' })
org.Contact.create(...)

// WRONG — npm install the old package
npm install @headlessly/sdk

// WRONG — CLI global install of old package
npm install -g @headlessly/cli

// WRONG — MCP as function calls
search({ type: 'Contact', filter: { stage: 'Lead' } })
fetch({ type: 'Contact', id: 'contact_1' })
do({ method: 'Contact.qualify', args: ['contact_1'] })
```

## Entity IDs

IDs use the format `{type}_{sqid}` — generated by [sqids](https://sqids.org/) with a blocklist to prevent offensive strings:

- `contact_fX9bL5nRd`, `deal_k7TmPvQx`, `issue_pQ8xNfKm`
- Never `contact_1`, `contact_123`, `contact_abc`
- Keep IDs consistent within a page (same contact referenced throughout)

## Code-is-Contract

All code snippets will be extracted and run as automated e2e tests. If the code doesn't work, either fix the SDK or fix the doc. Write examples as if they are executable tests.

Features not yet live must be labeled:

```typescript
// Coming soon — verb conjugation via SDK
await Contact.qualify({ id: 'contact_1' })
```

## Content Quality

- One idea per page. If a page covers SDK + MCP + CLI + REST, it's four pages.
- Lead with the code block, then explain. Developers read code first.
- Use `##` headers that are concrete and active: "Create a Contact" not "Creating Entities"
- Every page should have at least one working code example
- Cross-link to related pages: entity references, journey phases, integrations
- No emojis unless explicitly requested
